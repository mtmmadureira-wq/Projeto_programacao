<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maria Teresa Mendes Madureira">

<title>trabalho_introR</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="R_project_files/libs/clipboard/clipboard.min.js"></script>
<script src="R_project_files/libs/quarto-html/quarto.js"></script>
<script src="R_project_files/libs/quarto-html/popper.min.js"></script>
<script src="R_project_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="R_project_files/libs/quarto-html/anchor.min.js"></script>
<link href="R_project_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="R_project_files/libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="R_project_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="R_project_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="R_project_files/libs/bootstrap/bootstrap-1bc8a17f135ab3d594c857e9f48e611b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">trabalho_introR</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Maria Teresa Mendes Madureira </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="poverty-data-transfers-gender-inequality--an-analysis-of-time-distribution-inside-families-of-mexico" class="level1">
<h1>poverty, data transfers gender inequality- an analysis of time distribution inside families of Mexico</h1>
<p><a href="#introduction-to-progresa-and-the-database.">Introduction to Progresa and the database.</a></p>
<p><a href="#some-necessary-information-about-the-main-variables.">Some necessary information about the main variables.</a></p>
<p><a href="#cleaning-the-dataset-and-uploading-libraries">Cleaning the dataset and uploading libraries</a></p>
<p><a href="#variable-dictionary">Variable dictionary</a></p>
<p><a href="#understanding-family-income">Understanding family income</a></p>
<p><a href="#understanding-time-distribution">Understanding time distribution</a></p>
<p><a href="#next-steps">Next steps</a></p>
<section id="introduction-to-progresa-and-the-database." class="level2">
<h2 class="anchored" data-anchor-id="introduction-to-progresa-and-the-database.">Introduction to Progresa and the database.</h2>
<p>Mexico is similar to Brazil in many ways. Both countries face similar challenges in poverty, gender inequality and integrating families from isolated regions into the national economic network. They also have a similar solution to some of these problems- conditional cash transfer programs. Mexico has a very close equivalent to our “Bolsa Família”, which was originally called “Progresa”. Although “Progresa” is its original name, the program went through many rebrandings through the years, and is also known as “Oportunidades” and “Prospera”. Currently, what we understand as Progresa functions under the many programs coordenated by the Secretaria de Bienestar.</p>
<p>Progresa, like Bolsa Familia, is a conditional cash transfer, and requires minors to be enrolled in school, make yearly visits to the doctor and be fully vaccinated. However, its target audience is slightly different from Bolsa Familia’s. Progresa targets families in isolated areas, and so in addition to individual poverty participants must also belong to marginalized regions. The way cities and villages are categorized is not fully disclosed to the public, but it is known it is a mixture of access to basic infrastructure, average income percapita and expenditure on different goods.</p>
<p>Here, I will explore variables affecting time and income distribution, and analyse the impact that progresa had on poorer families. I will focus on women and underage girls.</p>
<section id="accessing-the-database" class="level3">
<h3 class="anchored" data-anchor-id="accessing-the-database">Accessing the database</h3>
<p>The datasets used to be available in the progresa website, before the program went through an agressive rebranding. I will use data from 2008. At that point, the program had been active for 18 years. Currently, social programs including what we understand as progresa can be found under “Bienestar”.</p>
<p>I use five datasets-</p>
<ol type="1">
<li><p>Hogares- information on basic infrastructure and household</p></li>
<li><p>Poplación- information on the individual</p></li>
<li><p>Ingreso- information on sources of income</p></li>
<li><p>Concentrado- general information</p></li>
<li><p>trabajo- information on jobs and work-related income</p></li>
</ol>
<section id="technical-information" class="level4">
<h4 class="anchored" data-anchor-id="technical-information">technical information:</h4>
</section>
<section id="bienestar-website" class="level4">
<h4 class="anchored" data-anchor-id="bienestar-website"><a href="https://www.gob.mx/becasbenitojuarez">Bienestar website</a></h4>
<p>r version- R 4.5.1</p>
<p>reference year- 2008</p>
</section>
</section>
</section>
<section id="some-necessary-information-about-the-main-variables." class="level2">
<h2 class="anchored" data-anchor-id="some-necessary-information-about-the-main-variables.">Some necessary information about the main variables.</h2>
<section id="conapo" class="level3">
<h3 class="anchored" data-anchor-id="conapo">Conapo</h3>
<p>Conapo is the way policy-makers classify towns and villages. It is a technical classification, so the alterations I make for it to become more intuitive do not harm the comprehension of my observations in any way. Conapo ranges from Highly Marginalized town (1) to Not marginalized (5).</p>
<p>Marginalization is a combination of different variables, amongst them avg expenditure, access to different forms of infrastructure, and income. The exact calculation does not seem to be publically available. Conapo already takes into account geographic discrimination, so what I classify here as larger towns are not below 3 in the Conapo scale.</p>
</section>
<section id="progresa" class="level3">
<h3 class="anchored" data-anchor-id="progresa">Progresa</h3>
<p>Although I compared progresa to bolsa familia, they have one relevant difference- progresa was born as a rural-focused program, so the data transfer is available only to people from Conapo&lt;3 towns. Aditionally, the income per capita of family members needs to be below 900 mexican pesos.</p>
<p>The program’s requirements aside from income/region are similar to bolsa familia’s- children must be in school, vaccinated and go on yearly visits to the doctors. To account for gender inequality and combat the issue of women leaving school earlier than men, progresa transfers a larger amount to families with daughters enrolled in school.</p>
</section>
<section id="time-expenditure" class="level3">
<h3 class="anchored" data-anchor-id="time-expenditure">Time expenditure</h3>
<p>Follows the categories of time distribution I use here. These will be measured in minutes and are available for anyone above 8 years old:</p>
<ul>
<li><p>Fetching water</p></li>
<li><p>care taking</p></li>
<li><p>household chores</p></li>
<li><p>free time</p></li>
<li><p>maintenance</p></li>
</ul>
</section>
<section id="household-expenditure-distribution" class="level3">
<h3 class="anchored" data-anchor-id="household-expenditure-distribution">Household expenditure distribution</h3>
<p>Here, I will work with the percentage of each good in relation to the total household consumption. I focus on the following categories:</p>
<ul>
<li><p>food</p></li>
<li><p>clothes</p></li>
<li><p>education</p></li>
<li><p>transportation</p></li>
<li><p>personal</p></li>
</ul>
</section>
</section>
<section id="cleaning-the-dataset-and-uploading-libraries" class="level2">
<h2 class="anchored" data-anchor-id="cleaning-the-dataset-and-uploading-libraries">Cleaning the dataset and uploading libraries</h2>
<p>Before any analysis, I load all the libraries and datasets, and transform the variables into the formats described above.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#loading all the necessary libraries</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readstata13)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Here I import and clean any and all necessary dataframes, merging them into a single df which will be the only one used throughout the project.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#importing the necessary datasets</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Here, the user sets the adress to wherever the databases are in their computer</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">alm</span><span class="sc">\\</span><span class="st">Dropbox</span><span class="sc">\\</span><span class="st">ENIGH analysis</span><span class="sc">\\</span><span class="st">2008</span><span class="sc">\\</span><span class="st">Data"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co"># calling the datasets by name</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readstata13)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>file_pop  <span class="ot">&lt;-</span> <span class="fu">read.dta13</span>(<span class="st">"NCV_Poblacion_2008_concil_2010.dta"</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>file_hog  <span class="ot">&lt;-</span> <span class="fu">read.dta13</span>(<span class="st">"NCV_Hogares_2008_concil_2010.dta"</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>file_conc <span class="ot">&lt;-</span> <span class="fu">read.dta13</span>(<span class="st">"NCV_Concentrado_2008_concil_2010.dta"</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>file_trab <span class="ot">&lt;-</span> <span class="fu">read.dta13</span>(<span class="st">"NCV_Trabajos_2008_concil_2010.dta"</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>file_ing  <span class="ot">&lt;-</span> <span class="fu">read.dta13</span>(<span class="st">"NCV_Ingresos_2008_concil_2010.dta"</span>, <span class="at">convert.factors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="co">#since the datasets are extremely large, it would be impractical to import all the columns. Here I only import the ones I will need.</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>new_data_ing<span class="ot">&lt;-</span>file_ing[,<span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>,<span class="st">"numren"</span>,<span class="st">"clave"</span>,<span class="st">"ing_tri"</span>)]</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>new_data_pop <span class="ot">&lt;-</span> file_pop[, <span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>,<span class="st">"numren"</span>,<span class="st">"sexo"</span>,<span class="st">"parentesco"</span>,<span class="st">"edad"</span>,<span class="st">"edo_salud"</span>,<span class="st">"lengua6"</span>,<span class="st">"alfabe"</span>,<span class="st">"asis_esc"</span>,<span class="st">"nivel"</span>,<span class="st">"beca"</span>,<span class="st">"edocony"</span>,<span class="st">"redsoc_1"</span>,<span class="st">"redsoc_3"</span>,<span class="st">"redsoc_6"</span>,<span class="st">"min_1"</span>,<span class="st">"hor_1"</span>,<span class="st">"min_2"</span>,<span class="st">"hor_2"</span>,<span class="st">"min_3"</span>,<span class="st">"hor_3"</span>,<span class="st">"min_4"</span>,<span class="st">"hor_4"</span>,<span class="st">"min_5"</span>,<span class="st">"hor_5"</span>,<span class="st">"hijos_viv"</span>,<span class="st">"trabajo"</span>,<span class="st">"bustrab_1"</span>,<span class="st">"bustrab_4"</span>,<span class="st">"bustrab_5"</span>)]</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>new_data_hog<span class="ot">&lt;-</span>file_hog[, <span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>,<span class="st">"claviv"</span>,<span class="st">"agua13"</span>,<span class="st">"lavad"</span>,<span class="st">"pileta"</span>,<span class="st">"residentes"</span>,<span class="st">"conapo"</span>)]</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>new_data_conc<span class="ot">&lt;-</span>file_conc[,<span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>,<span class="st">"ingcor"</span>,<span class="st">"ingtrab"</span>,<span class="st">"sexo"</span>,<span class="st">"estrato"</span>,<span class="st">"conapo"</span>,<span class="st">"ed_formal"</span>,<span class="st">"tam_hog"</span>,<span class="st">"hombres"</span>,<span class="st">"mujeres"</span>,<span class="st">"tot_hom"</span>,<span class="st">"tot_muj"</span>,<span class="st">"n_ocup"</span>,<span class="st">"beca"</span>,<span class="st">"bene_gob"</span>,<span class="st">"vestido"</span>,<span class="st">"educacion"</span>,<span class="st">"personal"</span>,<span class="st">"alimentos"</span>,<span class="st">"salud"</span>,<span class="st">"mante"</span>,<span class="st">"limpieza"</span>,<span class="st">"transporte"</span>,<span class="st">"vivienda"</span>,<span class="st">"smg"</span>)]</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>new_data_trab<span class="ot">&lt;-</span>file_trab[,<span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>,<span class="st">"numren"</span>,<span class="st">"htrab"</span>)]</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co">#pegando só o progresa e deixando a base compreensível </span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>progresa_info <span class="ot">&lt;-</span> new_data_ing <span class="sc">%&gt;%</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(clave <span class="sc">==</span> <span class="st">"P042"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(folioviv, numren, ing_tri) <span class="sc">%&gt;%</span> </span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">progresa =</span> <span class="st">"progresa"</span>) </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>progresa_flag <span class="ot">&lt;-</span> new_data_ing <span class="sc">%&gt;%</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(folioviv, numren) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(progresa_info, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"numren"</span>))</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="co">#in order for us to only work with a single database, I merge all of them while making sure that no lines repeat themselves</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="co">#juntando tudo em uma só base</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>new_data_conc<span class="ot">&lt;-</span>new_data_conc<span class="sc">%&gt;%</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">sexo_chefe=</span>sexo)</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>merged1 <span class="ot">&lt;-</span> <span class="fu">merge</span>(new_data_pop, new_data_trab, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>,<span class="st">"numren"</span>),<span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>merged2<span class="ot">&lt;-</span><span class="fu">merge</span>(merged1, new_data_hog, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"foliohog"</span>),<span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>merged3<span class="ot">&lt;-</span><span class="fu">merge</span>(merged2, progresa_info, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"folioviv"</span>,<span class="st">"numren"</span>),<span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>final_base <span class="ot">&lt;-</span> <span class="fu">merge</span>(merged3, new_data_conc, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"folioviv"</span>, <span class="st">"foliohog"</span>),<span class="at">all.x =</span> <span class="cn">TRUE</span>)</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>asis_esc <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_base<span class="sc">$</span>asis_esc,</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>                              <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>                              <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Sim"</span>, <span class="st">"Não"</span>))</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sexo <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_base<span class="sc">$</span>sexo, </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>                          <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>                          <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Menino"</span>,<span class="st">"Menina"</span>))</span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sexo_chefe <span class="ot">&lt;-</span> <span class="fu">factor</span>(final_base<span class="sc">$</span>sexo_chefe, </span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>                                <span class="at">levels =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>                                <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"homem"</span>,<span class="st">"mulher"</span>))</span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a><span class="co"># Here I rename some columns with more intuitive names</span></span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>final_base <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(</span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">lar=</span>foliohog,</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">infovivienda=</span>claviv,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">acesso_agua=</span>agua13,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">conapo=</span>conapo.x,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    <span class="at">sua_saude=</span>edo_salud,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">lingua_indigena=</span>lengua6,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">ganha_bolsa=</span>beca.x,</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">sit_conjugal=</span>edocony,</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">conapo2=</span>conapo.y,</span>
<span id="cb2-65"><a href="#cb2-65" aria-hidden="true" tabindex="-1"></a>    <span class="at">numero_trabalhadores=</span>n_ocup,</span>
<span id="cb2-66"><a href="#cb2-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">valor_bolsa=</span>beca.y,</span>
<span id="cb2-67"><a href="#cb2-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">renda_tot=</span>ingcor</span>
<span id="cb2-68"><a href="#cb2-68" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-69"><a href="#cb2-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-70"><a href="#cb2-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-71"><a href="#cb2-71" aria-hidden="true" tabindex="-1"></a><span class="co">#since I will work with time expenditure, I transform everything here into minutes and transform the "99", which means "no time spent" into 0.</span></span>
<span id="cb2-72"><a href="#cb2-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-73"><a href="#cb2-73" aria-hidden="true" tabindex="-1"></a>final_base[, <span class="fu">c</span>(<span class="st">"hor_4"</span>, <span class="st">"min_4"</span>, <span class="st">"hor_5"</span>,<span class="st">"min_5"</span>,<span class="st">"hor_1"</span>,<span class="st">"min_1"</span>,<span class="st">"hor_2"</span>,<span class="st">"min_2"</span>,<span class="st">"hor_3"</span>,<span class="st">"min_3"</span>)] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(final_base[, <span class="fu">c</span>(<span class="st">"hor_4"</span>, <span class="st">"min_4"</span>, <span class="st">"hor_5"</span>,<span class="st">"min_5"</span>,<span class="st">"hor_1"</span>,<span class="st">"min_1"</span>,<span class="st">"hor_2"</span>,<span class="st">"min_2"</span>,<span class="st">"hor_3"</span>,<span class="st">"min_3"</span>)], <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">==</span> <span class="dv">99</span>, <span class="dv">0</span>, x))</span>
<span id="cb2-74"><a href="#cb2-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-75"><a href="#cb2-75" aria-hidden="true" tabindex="-1"></a>final_base[, <span class="fu">c</span>(<span class="st">"hor_4"</span>, <span class="st">"hor_5"</span>,<span class="st">"hor_1"</span>,<span class="st">"hor_2"</span>,<span class="st">"hor_3"</span>)] <span class="ot">&lt;-</span> final_base[, <span class="fu">c</span>(<span class="st">"hor_4"</span>, <span class="st">"hor_5"</span>,<span class="st">"hor_1"</span>,<span class="st">"hor_2"</span>,<span class="st">"hor_3"</span>)]<span class="sc">*</span><span class="dv">60</span></span>
<span id="cb2-76"><a href="#cb2-76" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>tempo_cuida<span class="ot">&lt;-</span>final_base<span class="sc">$</span>hor_1<span class="sc">+</span>final_base<span class="sc">$</span>min_1</span>
<span id="cb2-77"><a href="#cb2-77" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>tempo_repara<span class="ot">&lt;-</span>final_base<span class="sc">$</span>hor_2<span class="sc">+</span>final_base<span class="sc">$</span>min_2</span>
<span id="cb2-78"><a href="#cb2-78" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>tempo_domestico<span class="ot">&lt;-</span>final_base<span class="sc">$</span>hor_3<span class="sc">+</span>final_base<span class="sc">$</span>min_3</span>
<span id="cb2-79"><a href="#cb2-79" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>tempo_agua<span class="ot">&lt;-</span>final_base<span class="sc">$</span>hor_4<span class="sc">+</span>final_base<span class="sc">$</span>min_4</span>
<span id="cb2-80"><a href="#cb2-80" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>tempo_prazer<span class="ot">&lt;-</span>final_base<span class="sc">$</span>hor_5<span class="sc">+</span>final_base<span class="sc">$</span>min_5</span>
<span id="cb2-81"><a href="#cb2-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-82"><a href="#cb2-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-83"><a href="#cb2-83" aria-hidden="true" tabindex="-1"></a><span class="co">#The conapo nomencalture is messy (it doesn't have an ascending or a descending order) so I sort the marginalization levels into descending order, 1 being the most marginalized and 5 being not marginalized at all. It is worth remembering that "conapo" is a classification of a city or village, not of a family. I also classify the size of a certain village. I do this to check that all progresa receivers are from smaller communities.</span></span>
<span id="cb2-84"><a href="#cb2-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-85"><a href="#cb2-85" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo<span class="ot">&lt;-</span>final_base<span class="sc">$</span>conapo<span class="sc">*</span><span class="dv">10</span></span>
<span id="cb2-86"><a href="#cb2-86" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo[final_base<span class="sc">$</span>conapo<span class="sc">==</span><span class="dv">10</span>]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb2-87"><a href="#cb2-87" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo[final_base<span class="sc">$</span>conapo<span class="sc">==</span><span class="dv">20</span>]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb2-88"><a href="#cb2-88" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo[final_base<span class="sc">$</span>conapo<span class="sc">==</span><span class="dv">30</span>]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb2-89"><a href="#cb2-89" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo[final_base<span class="sc">$</span>conapo<span class="sc">==</span><span class="dv">40</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb2-90"><a href="#cb2-90" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>conapo[final_base<span class="sc">$</span>conapo<span class="sc">==</span><span class="dv">50</span>]<span class="ot">&lt;-</span><span class="dv">5</span></span>
<span id="cb2-91"><a href="#cb2-91" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"tam&gt;100k"</span></span>
<span id="cb2-92"><a href="#cb2-92" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">"15k&lt;tam&lt;100k"</span></span>
<span id="cb2-93"><a href="#cb2-93" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="st">"2,5k&lt;tam&lt;15k"</span></span>
<span id="cb2-94"><a href="#cb2-94" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="st">"tam&lt;2,5k"</span></span>
<span id="cb2-95"><a href="#cb2-95" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>redsoc_1[final_base<span class="sc">$</span>redsoc_1<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-96"><a href="#cb2-96" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>redsoc_3[final_base<span class="sc">$</span>redsoc_3<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-97"><a href="#cb2-97" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>redsoc_6[final_base<span class="sc">$</span>redsoc_6<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-98"><a href="#cb2-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-99"><a href="#cb2-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-100"><a href="#cb2-100" aria-hidden="true" tabindex="-1"></a><span class="co">#since I will work with expenditure distribution inside a household, I transform the specific categories into percentages of the total expenditure.</span></span>
<span id="cb2-101"><a href="#cb2-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-102"><a href="#cb2-102" aria-hidden="true" tabindex="-1"></a>final_base <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-103"><a href="#cb2-103" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porcent_vest =</span> vestido <span class="sc">/</span> (renda_tot), <span class="at">porcent_edu=</span>educacion<span class="sc">/</span>(renda_tot))</span>
<span id="cb2-104"><a href="#cb2-104" aria-hidden="true" tabindex="-1"></a>final_base<span class="ot">&lt;-</span>final_base<span class="sc">%&gt;%</span></span>
<span id="cb2-105"><a href="#cb2-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">porcent_vest=</span>vestido<span class="sc">/</span>renda_tot,<span class="at">porcent_edu=</span>educacion<span class="sc">/</span>renda_tot,<span class="at">porcent_sld=</span> salud<span class="sc">/</span>(renda_tot), <span class="at">porcent_trans=</span>transporte<span class="sc">/</span>(renda_tot),<span class="at">porcent_pers=</span>personal<span class="sc">/</span>(renda_tot), <span class="at">porcent_ali=</span>alimentos<span class="sc">/</span>(renda_tot), <span class="at">porcent_viv=</span>vivienda<span class="sc">/</span>(renda_tot), <span class="at">porcent_limp=</span>limpieza<span class="sc">/</span>(renda_tot), <span class="at">porcent_man=</span>mante<span class="sc">/</span>(renda_tot))</span>
<span id="cb2-106"><a href="#cb2-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-107"><a href="#cb2-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-108"><a href="#cb2-108" aria-hidden="true" tabindex="-1"></a><span class="co">#Here I differentiate different marital statuses. I want to observe how being single vs married may impact our results, but since the database has categories like "stable union" and "widowed", I transform all of those into either "solteiro" or "casado".</span></span>
<span id="cb2-109"><a href="#cb2-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-110"><a href="#cb2-110" aria-hidden="true" tabindex="-1"></a>final_base <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-111"><a href="#cb2-111" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sit_conjugal_chefe =</span> <span class="fu">ifelse</span>(parentesco <span class="sc">==</span> <span class="dv">101</span>, sit_conjugal, <span class="cn">NA</span>))</span>
<span id="cb2-112"><a href="#cb2-112" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">'casado'</span></span>
<span id="cb2-113"><a href="#cb2-113" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="st">'casado'</span></span>
<span id="cb2-114"><a href="#cb2-114" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">'solteiro'</span></span>
<span id="cb2-115"><a href="#cb2-115" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="st">'solteiro'</span></span>
<span id="cb2-116"><a href="#cb2-116" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="st">'solteiro'</span></span>
<span id="cb2-117"><a href="#cb2-117" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>sit_conjugal_chefe[final_base<span class="sc">$</span>sit_conjugal_chefe<span class="sc">==</span><span class="dv">6</span>]<span class="ot">&lt;-</span><span class="st">'solteiro'</span></span>
<span id="cb2-118"><a href="#cb2-118" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"tam&gt;100k"</span></span>
<span id="cb2-119"><a href="#cb2-119" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="st">"15k&lt;tam&lt;100k"</span></span>
<span id="cb2-120"><a href="#cb2-120" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="st">"2,5k&lt;tam&lt;15k"</span></span>
<span id="cb2-121"><a href="#cb2-121" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>estrato[final_base<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="st">"tam&lt;2,5k"</span></span>
<span id="cb2-122"><a href="#cb2-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-123"><a href="#cb2-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-124"><a href="#cb2-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-125"><a href="#cb2-125" aria-hidden="true" tabindex="-1"></a><span class="co">#here I eliminate a few columns I have already compiled into other (more relevant) columns, so that the original ones are no longer useful.</span></span>
<span id="cb2-126"><a href="#cb2-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-127"><a href="#cb2-127" aria-hidden="true" tabindex="-1"></a>final_base[,<span class="fu">c</span>(<span class="st">"lavad"</span>,<span class="st">"pileta"</span>,<span class="st">"acesso_agua"</span>,<span class="st">"lingua_indigena"</span>,<span class="st">"bustrab_1"</span>,<span class="st">"bustrab_4"</span>,<span class="st">"bustrab_5"</span>,<span class="st">"hombres"</span>,<span class="st">"mujeres"</span>,<span class="st">"min_1"</span>,<span class="st">"min_2"</span>,<span class="st">"min_3"</span>,<span class="st">"min_4"</span>,<span class="st">"min_5"</span>,<span class="st">"hor_1"</span>,<span class="st">"hor_2"</span>,<span class="st">"hor_3"</span>,<span class="st">"hor_4"</span>,<span class="st">"hor_5"</span>,<span class="st">"educacion"</span>,<span class="st">'salud'</span>,<span class="st">"transporte"</span>,<span class="st">"vivienda"</span>,<span class="st">"personal"</span>,<span class="st">"limpieza"</span>,<span class="st">"alimentos"</span>,<span class="st">"vestido"</span>,<span class="st">"mante"</span>)] <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb2-128"><a href="#cb2-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-129"><a href="#cb2-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-130"><a href="#cb2-130" aria-hidden="true" tabindex="-1"></a>base_chefes <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-131"><a href="#cb2-131" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(sit_conjugal_chefe))</span>
<span id="cb2-132"><a href="#cb2-132" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>estrato[base_chefes<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="dv">4</span></span>
<span id="cb2-133"><a href="#cb2-133" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>estrato[base_chefes<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">2</span>]<span class="ot">&lt;-</span><span class="dv">3</span></span>
<span id="cb2-134"><a href="#cb2-134" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>estrato[base_chefes<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">3</span>]<span class="ot">&lt;-</span><span class="dv">2</span></span>
<span id="cb2-135"><a href="#cb2-135" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>estrato[base_chefes<span class="sc">$</span>estrato<span class="sc">==</span><span class="dv">4</span>]<span class="ot">&lt;-</span><span class="dv">1</span></span>
<span id="cb2-136"><a href="#cb2-136" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>redsoc_6[base_chefes<span class="sc">$</span>redsoc_6<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-137"><a href="#cb2-137" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>redsoc_1[base_chefes<span class="sc">$</span>redsoc_1<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-138"><a href="#cb2-138" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>redsoc_3[base_chefes<span class="sc">$</span>redsoc_3<span class="sc">==</span><span class="dv">5</span>]<span class="ot">&lt;-</span><span class="fl">2.5</span></span>
<span id="cb2-139"><a href="#cb2-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-140"><a href="#cb2-140" aria-hidden="true" tabindex="-1"></a>base_chefes <span class="ot">&lt;-</span> base_chefes <span class="sc">%&gt;%</span></span>
<span id="cb2-141"><a href="#cb2-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_sit =</span> <span class="fu">paste</span>(sexo_chefe, sit_conjugal_chefe, <span class="at">sep =</span> <span class="st">" "</span>))</span>
<span id="cb2-142"><a href="#cb2-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-143"><a href="#cb2-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-144"><a href="#cb2-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-145"><a href="#cb2-145" aria-hidden="true" tabindex="-1"></a><span class="co">#Here, I attribute family titles to each member of the family to check how they relate to each other. All codenumbers used can be found in the dictionary linked in the introduction. I also create a new variable sexo_chefe. More information about this variable may be found in the variable dictionary.</span></span>
<span id="cb2-146"><a href="#cb2-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-147"><a href="#cb2-147" aria-hidden="true" tabindex="-1"></a>final_base<span class="ot">&lt;-</span>final_base<span class="sc">%&gt;%</span></span>
<span id="cb2-148"><a href="#cb2-148" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_sit=</span><span class="fu">paste</span>(sexo_chefe, sit_conjugal_chefe, <span class="at">sep =</span> <span class="st">" "</span>))</span>
<span id="cb2-149"><a href="#cb2-149" aria-hidden="true" tabindex="-1"></a>base_chefes[, <span class="fu">c</span>(<span class="st">"sexo"</span>,<span class="st">"sit_conjugal"</span>,<span class="st">"conapo2"</span>,<span class="st">"hijos_viv"</span>,<span class="st">"ingtrab"</span>,<span class="st">"parentesco"</span>,<span class="st">"sit_conjugal_chefe"</span>,<span class="st">"sexo_chefe"</span>)] <span class="ot">&lt;-</span><span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb2-150"><a href="#cb2-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-151"><a href="#cb2-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-152"><a href="#cb2-152" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>parentesco[final_base<span class="sc">$</span>parentesco<span class="sc">==</span><span class="dv">101</span>]<span class="ot">&lt;-</span> <span class="st">"chefe"</span></span>
<span id="cb2-153"><a href="#cb2-153" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>parentesco[final_base<span class="sc">$</span>parentesco <span class="sc">%in%</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">203</span>] <span class="ot">&lt;-</span> <span class="st">"partner"</span></span>
<span id="cb2-154"><a href="#cb2-154" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>parentesco[final_base<span class="sc">$</span>parentesco <span class="sc">%in%</span> <span class="dv">301</span><span class="sc">:</span><span class="dv">305</span>] <span class="ot">&lt;-</span> <span class="st">"filho(a)"</span></span>
<span id="cb2-155"><a href="#cb2-155" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>parentesco[final_base<span class="sc">$</span>parentesco <span class="sc">%in%</span> <span class="dv">401</span><span class="sc">:</span><span class="dv">412</span>] <span class="ot">&lt;-</span> <span class="st">"trabalhador(a)"</span></span>
<span id="cb2-156"><a href="#cb2-156" aria-hidden="true" tabindex="-1"></a>final_base<span class="sc">$</span>parentesco[final_base<span class="sc">$</span>parentesco <span class="sc">%in%</span> <span class="dv">601</span><span class="sc">:</span><span class="dv">623</span>] <span class="ot">&lt;-</span> <span class="st">"outro parente"</span></span>
<span id="cb2-157"><a href="#cb2-157" aria-hidden="true" tabindex="-1"></a>base_chefes<span class="sc">$</span>porcent_trans[base_chefes<span class="sc">$</span>porcent_trans<span class="sc">&gt;</span><span class="dv">1</span>]<span class="ot">&lt;-</span><span class="st">"i"</span></span>
<span id="cb2-158"><a href="#cb2-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-159"><a href="#cb2-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-160"><a href="#cb2-160" aria-hidden="true" tabindex="-1"></a><span class="co">#since my focus is family dynamics, here I create the database I will use from now on. It includes only families with children (that is, one "chefe" and at least one "filho(a)", aside from other possible participants). I used Chat-GPT here.</span></span>
<span id="cb2-161"><a href="#cb2-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-162"><a href="#cb2-162" aria-hidden="true" tabindex="-1"></a><span class="co"># First, find all families that have at least one son or daughter</span></span>
<span id="cb2-163"><a href="#cb2-163" aria-hidden="true" tabindex="-1"></a>families_with_children <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-164"><a href="#cb2-164" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parentesco <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"filho(a)"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-165"><a href="#cb2-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(folioviv)</span>
<span id="cb2-166"><a href="#cb2-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-167"><a href="#cb2-167" aria-hidden="true" tabindex="-1"></a><span class="co"># Then, keep only rows from those families in the main dataset</span></span>
<span id="cb2-168"><a href="#cb2-168" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> final_base <span class="sc">%&gt;%</span></span>
<span id="cb2-169"><a href="#cb2-169" aria-hidden="true" tabindex="-1"></a>  <span class="fu">semi_join</span>(families_with_children, <span class="at">by =</span> <span class="st">"folioviv"</span>)</span>
<span id="cb2-170"><a href="#cb2-170" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>sex_sit[<span class="st">"homem casado"</span><span class="ot">&lt;-</span><span class="st">"casado"</span>]</span>
<span id="cb2-171"><a href="#cb2-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-172"><a href="#cb2-172" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 1: Extract the sex_sit of the chief per family</span></span>
<span id="cb2-173"><a href="#cb2-173" aria-hidden="true" tabindex="-1"></a>sex_sit_by_family <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-174"><a href="#cb2-174" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(parentesco <span class="sc">==</span> <span class="st">"chefe"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-175"><a href="#cb2-175" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(folioviv, <span class="at">sex_sit_chefe =</span> sex_sit)</span>
<span id="cb2-176"><a href="#cb2-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-177"><a href="#cb2-177" aria-hidden="true" tabindex="-1"></a><span class="co"># Step 2: Join it back to the full dataset and optionally tag the chief</span></span>
<span id="cb2-178"><a href="#cb2-178" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-179"><a href="#cb2-179" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sex_sit_by_family, <span class="at">by =</span> <span class="st">"folioviv"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-180"><a href="#cb2-180" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-181"><a href="#cb2-181" aria-hidden="true" tabindex="-1"></a>    <span class="at">sex_sit_final =</span> <span class="fu">ifelse</span>(parentesco <span class="sc">==</span> <span class="st">"chefe"</span>,</span>
<span id="cb2-182"><a href="#cb2-182" aria-hidden="true" tabindex="-1"></a>                           <span class="fu">paste0</span>(sex_sit_chefe, <span class="st">" (chief)"</span>),</span>
<span id="cb2-183"><a href="#cb2-183" aria-hidden="true" tabindex="-1"></a>                           sex_sit_chefe)</span>
<span id="cb2-184"><a href="#cb2-184" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb2-185"><a href="#cb2-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-186"><a href="#cb2-186" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>sex_sit_final[df_with_children<span class="sc">$</span>sex_sit_final<span class="sc">==</span><span class="st">'homem casado'</span>]<span class="ot">&lt;-</span><span class="st">"married"</span></span>
<span id="cb2-187"><a href="#cb2-187" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>sex_sit_final[df_with_children<span class="sc">$</span>sex_sit_final<span class="sc">==</span><span class="st">'mulher casado'</span>]<span class="ot">&lt;-</span><span class="st">"married"</span></span>
<span id="cb2-188"><a href="#cb2-188" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>sex_sit_final[df_with_children<span class="sc">$</span>sex_sit_final<span class="sc">==</span><span class="st">'homem casado (chief)'</span>]<span class="ot">&lt;-</span><span class="st">"married (chefe)"</span></span>
<span id="cb2-189"><a href="#cb2-189" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>sex_sit_final[df_with_children<span class="sc">$</span>sex_sit_final<span class="sc">==</span><span class="st">'mulher casado'</span>]<span class="ot">&lt;-</span><span class="st">"married (chefe)"</span></span>
<span id="cb2-190"><a href="#cb2-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-191"><a href="#cb2-191" aria-hidden="true" tabindex="-1"></a><span class="co">#getting rid of a few variables and dfs I won't use in this specific project</span></span>
<span id="cb2-192"><a href="#cb2-192" aria-hidden="true" tabindex="-1"></a>df_with_children[,<span class="fu">c</span>(<span class="st">"sit_conjugal_chefe"</span>,<span class="st">"sex_sit"</span>,<span class="st">"ingtrab"</span>,<span class="st">"conapo2"</span>,<span class="st">"ed_formal"</span>,<span class="st">"smg"</span>,<span class="st">"sexo_chefe"</span>,<span class="st">"numero_trabalhadores"</span>,<span class="st">"hijos_viv"</span>,<span class="st">"sua_saude"</span>,<span class="st">"sex_sit_chefe"</span>)]<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb2-193"><a href="#cb2-193" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(base_agua, base_chefes, file_hog, file_ing, file_pop, file_trab, merged1, merged2, merged3,duplicatas,file_conc, final_base,final_base_sem_duplicatas,menores_progresa,new_data_hog,new_data_pop)</span>
<span id="cb2-194"><a href="#cb2-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-195"><a href="#cb2-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-196"><a href="#cb2-196" aria-hidden="true" tabindex="-1"></a><span class="co">#Double checking that there are no duplicate lines and deleting them. I used chat gpt here.</span></span>
<span id="cb2-197"><a href="#cb2-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-198"><a href="#cb2-198" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. Contar quantas vezes cada linha aparece</span></span>
<span id="cb2-199"><a href="#cb2-199" aria-hidden="true" tabindex="-1"></a>duplicatas <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-200"><a href="#cb2-200" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>(<span class="fu">everything</span>())) <span class="sc">%&gt;%</span></span>
<span id="cb2-201"><a href="#cb2-201" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">freq =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb2-202"><a href="#cb2-202" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(freq))</span>
<span id="cb2-203"><a href="#cb2-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-204"><a href="#cb2-204" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar só as linhas duplicadas</span></span>
<span id="cb2-205"><a href="#cb2-205" aria-hidden="true" tabindex="-1"></a>duplicatas <span class="sc">%&gt;%</span> <span class="fu">filter</span>(freq <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb2-206"><a href="#cb2-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-207"><a href="#cb2-207" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. Eliminar duplicatas (mantendo apenas uma ocorrência de cada linha)</span></span>
<span id="cb2-208"><a href="#cb2-208" aria-hidden="true" tabindex="-1"></a>final_base_sem_duplicatas <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-209"><a href="#cb2-209" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb2-210"><a href="#cb2-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-211"><a href="#cb2-211" aria-hidden="true" tabindex="-1"></a><span class="co"># Conferir se deu certo</span></span>
<span id="cb2-212"><a href="#cb2-212" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(df_with_children)            <span class="co"># número de linhas original</span></span>
<span id="cb2-213"><a href="#cb2-213" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(final_base_sem_duplicatas) <span class="co"># número de linhas sem duplicadas</span></span>
<span id="cb2-214"><a href="#cb2-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-215"><a href="#cb2-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-216"><a href="#cb2-216" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="ot">&lt;-</span>final_base_sem_duplicatas</span>
<span id="cb2-217"><a href="#cb2-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-218"><a href="#cb2-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-219"><a href="#cb2-219" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-220"><a href="#cb2-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_sit_final =</span> <span class="fu">if_else</span>(</span>
<span id="cb2-221"><a href="#cb2-221" aria-hidden="true" tabindex="-1"></a>    parentesco <span class="sc">==</span> <span class="st">"partner"</span> <span class="sc">&amp;</span> sex_sit_final <span class="sc">==</span> <span class="st">"married"</span>,</span>
<span id="cb2-222"><a href="#cb2-222" aria-hidden="true" tabindex="-1"></a>    <span class="st">"married (partner)"</span>,</span>
<span id="cb2-223"><a href="#cb2-223" aria-hidden="true" tabindex="-1"></a>    sex_sit_final</span>
<span id="cb2-224"><a href="#cb2-224" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-225"><a href="#cb2-225" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-226"><a href="#cb2-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_sit_final =</span> <span class="fu">if_else</span>(</span>
<span id="cb2-227"><a href="#cb2-227" aria-hidden="true" tabindex="-1"></a>    sexo<span class="sc">==</span><span class="st">"Menina"</span> <span class="sc">&amp;</span> sex_sit_final <span class="sc">==</span> <span class="st">"married (chief)"</span>,</span>
<span id="cb2-228"><a href="#cb2-228" aria-hidden="true" tabindex="-1"></a>    <span class="st">"married (partner)"</span>,</span>
<span id="cb2-229"><a href="#cb2-229" aria-hidden="true" tabindex="-1"></a>    sex_sit_final</span>
<span id="cb2-230"><a href="#cb2-230" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-231"><a href="#cb2-231" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-232"><a href="#cb2-232" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex_sit_final =</span> <span class="fu">if_else</span>(</span>
<span id="cb2-233"><a href="#cb2-233" aria-hidden="true" tabindex="-1"></a>    sexo<span class="sc">==</span><span class="st">"Menina"</span> <span class="sc">&amp;</span> sex_sit_final <span class="sc">==</span><span class="st">"married (partner)"</span>,</span>
<span id="cb2-234"><a href="#cb2-234" aria-hidden="true" tabindex="-1"></a>    <span class="st">"married woman"</span>,</span>
<span id="cb2-235"><a href="#cb2-235" aria-hidden="true" tabindex="-1"></a>    sex_sit_final</span>
<span id="cb2-236"><a href="#cb2-236" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb2-237"><a href="#cb2-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-238"><a href="#cb2-238" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-239"><a href="#cb2-239" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(folioviv) <span class="sc">%&gt;%</span></span>
<span id="cb2-240"><a href="#cb2-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-241"><a href="#cb2-241" aria-hidden="true" tabindex="-1"></a>    <span class="at">ingr_tri =</span> <span class="fu">if_else</span>(</span>
<span id="cb2-242"><a href="#cb2-242" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if mother is partner</span></span>
<span id="cb2-243"><a href="#cb2-243" aria-hidden="true" tabindex="-1"></a>      (sexo <span class="sc">==</span> <span class="st">"Menina"</span> <span class="sc">&amp;</span> parentesco <span class="sc">==</span> <span class="st">"partner"</span>) <span class="sc">|</span></span>
<span id="cb2-244"><a href="#cb2-244" aria-hidden="true" tabindex="-1"></a>      <span class="co"># if mother is chefe and there is no partner</span></span>
<span id="cb2-245"><a href="#cb2-245" aria-hidden="true" tabindex="-1"></a>      (sexo <span class="sc">==</span> <span class="st">"Menina"</span> <span class="sc">&amp;</span> parentesco <span class="sc">==</span> <span class="st">"chefe"</span> <span class="sc">&amp;</span></span>
<span id="cb2-246"><a href="#cb2-246" aria-hidden="true" tabindex="-1"></a>         <span class="sc">!</span><span class="fu">any</span>(sexo <span class="sc">==</span> <span class="st">"Menina"</span> <span class="sc">&amp;</span> parentesco <span class="sc">==</span> <span class="st">"partner"</span>)),</span>
<span id="cb2-247"><a href="#cb2-247" aria-hidden="true" tabindex="-1"></a>      <span class="fu">sum</span>(ing_tri, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb2-248"><a href="#cb2-248" aria-hidden="true" tabindex="-1"></a>      <span class="cn">NA_real_</span></span>
<span id="cb2-249"><a href="#cb2-249" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-250"><a href="#cb2-250" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-251"><a href="#cb2-251" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-252"><a href="#cb2-252" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>ing_tri<span class="ot">&lt;-</span>df_with_children<span class="sc">$</span>ingr_tri</span>
<span id="cb2-253"><a href="#cb2-253" aria-hidden="true" tabindex="-1"></a>df_with_children<span class="sc">$</span>ing_tri[df_with_children<span class="sc">$</span>ing_tri<span class="sc">==</span><span class="fl">0.00</span>]<span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb2-254"><a href="#cb2-254" aria-hidden="true" tabindex="-1"></a>df_with_children[,<span class="fu">c</span>(<span class="st">"alfabe"</span>,<span class="st">"nivel"</span>,<span class="st">"sit_conjugal"</span>,<span class="st">"residentes"</span>,<span class="st">"infovivienda"</span>)]<span class="ot">&lt;-</span><span class="fu">list</span>(<span class="cn">NULL</span>)</span>
<span id="cb2-255"><a href="#cb2-255" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(base_agua, base_chefes, file_hog, file_ing, file_pop, file_trab, merged1, merged2, merged3,duplicatas,file_conc, final_base,final_base_sem_duplicatas,menores_progresa,new_data_hog,new_data_pop, new_data_ing,aprovados,mulheres_aprovadas,new_data_conc,new_data_trab,pessoas,progresa_flag,progresa_info,sex_sit_by_family,turma)</span>
<span id="cb2-256"><a href="#cb2-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-257"><a href="#cb2-257" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-258"><a href="#cb2-258" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(folioviv) <span class="sc">%&gt;%</span></span>
<span id="cb2-259"><a href="#cb2-259" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-260"><a href="#cb2-260" aria-hidden="true" tabindex="-1"></a>    <span class="at">progresa =</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(<span class="sc">!</span><span class="fu">is.na</span>(ing_tri)), <span class="st">"progresa"</span>, <span class="cn">NA</span>)</span>
<span id="cb2-261"><a href="#cb2-261" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-262"><a href="#cb2-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-263"><a href="#cb2-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-264"><a href="#cb2-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-265"><a href="#cb2-265" aria-hidden="true" tabindex="-1"></a><span class="co">#Here, I wanted to create a group to which I could safely compare progresa receivers to non-progresa receivers, and I chose to do so by comparing them to those who had slightly higher monthly income per capita.</span></span>
<span id="cb2-266"><a href="#cb2-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-267"><a href="#cb2-267" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-268"><a href="#cb2-268" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(folioviv) <span class="sc">%&gt;%</span></span>
<span id="cb2-269"><a href="#cb2-269" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-270"><a href="#cb2-270" aria-hidden="true" tabindex="-1"></a>    <span class="at">family_size =</span> <span class="fu">n</span>(),  <span class="co"># number of members in the household</span></span>
<span id="cb2-271"><a href="#cb2-271" aria-hidden="true" tabindex="-1"></a>    <span class="at">ing_percap =</span> renda_tot <span class="sc">/</span> family_size  <span class="co"># income per capita</span></span>
<span id="cb2-272"><a href="#cb2-272" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-273"><a href="#cb2-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb2-274"><a href="#cb2-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-275"><a href="#cb2-275" aria-hidden="true" tabindex="-1"></a><span class="co">#to make the analysis easier, I created a column containing the marital status of each family chief (and their possible partner)</span></span>
<span id="cb2-276"><a href="#cb2-276" aria-hidden="true" tabindex="-1"></a>df_with_children <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb2-277"><a href="#cb2-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(folioviv) <span class="sc">%&gt;%</span></span>
<span id="cb2-278"><a href="#cb2-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-279"><a href="#cb2-279" aria-hidden="true" tabindex="-1"></a>    <span class="co"># does this household have a partner?</span></span>
<span id="cb2-280"><a href="#cb2-280" aria-hidden="true" tabindex="-1"></a>    <span class="at">has_partner =</span> <span class="fu">any</span>(parentesco <span class="sc">==</span> <span class="st">"partner"</span>),</span>
<span id="cb2-281"><a href="#cb2-281" aria-hidden="true" tabindex="-1"></a>    <span class="at">marital_status =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-282"><a href="#cb2-282" aria-hidden="true" tabindex="-1"></a>      parentesco <span class="sc">==</span> <span class="st">"chefe"</span> <span class="sc">&amp;</span> has_partner <span class="sc">~</span> <span class="st">"not_single"</span>,</span>
<span id="cb2-283"><a href="#cb2-283" aria-hidden="true" tabindex="-1"></a>      parentesco <span class="sc">==</span> <span class="st">"partner"</span>             <span class="sc">~</span> <span class="st">"not_single"</span>,</span>
<span id="cb2-284"><a href="#cb2-284" aria-hidden="true" tabindex="-1"></a>      parentesco <span class="sc">==</span> <span class="st">"chefe"</span> <span class="sc">&amp;</span> <span class="sc">!</span>has_partner <span class="sc">~</span> <span class="st">"single"</span>,</span>
<span id="cb2-285"><a href="#cb2-285" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"not_relevant"</span></span>
<span id="cb2-286"><a href="#cb2-286" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-287"><a href="#cb2-287" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb2-288"><a href="#cb2-288" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb2-289"><a href="#cb2-289" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>has_partner)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="variable-dictionary" class="level2">
<h2 class="anchored" data-anchor-id="variable-dictionary">Variable dictionary</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gt)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>vars <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  Variável <span class="ot">=</span> <span class="fu">names</span>(df_with_children),</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Tipo =</span> <span class="fu">sapply</span>(df_with_children, <span class="cf">function</span>(x) <span class="fu">class</span>(x)[<span class="dv">1</span>]),</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  Descrição<span class="ot">=</span> <span class="fu">c</span>(<span class="st">"a 6 digit code unique to each household."</span>,<span class="st">"-"</span>,<span class="st">"ennumerates household members"</span>,<span class="st">"individual's gender"</span>,<span class="st">"individual's relation to house chief"</span>,<span class="st">"individual's age"</span>,<span class="st">"whether individual is enrolled in school"</span>,<span class="st">"whether the individual has a scholarship"</span>,<span class="st">"on a scale of 1-6, how much help could this individual get on a medical emergency"</span>,<span class="st">"---- family emergency"</span>,<span class="st">"---- another emergency"</span>,<span class="st">"whether the individual works"</span>,<span class="st">"how many hours the individual works"</span>,<span class="st">"the conapo category of the individual's town"</span>,<span class="st">"total family progresa transfers. Appears only in the mother's collumn."</span>,<span class="st">"whether the individual receives progresa transfers"</span>,<span class="st">"total family income"</span>,<span class="st">"size of individual's town"</span>,<span class="st">"number of individuals in the household"</span>,<span class="st">"number of men in the household"</span>,<span class="st">"number of women in the household"</span>,<span class="st">"individual's scholarship, if they receive it"</span>,<span class="st">"same as ing_tri, but distributed among all family recipients"</span>,<span class="st">"minutes per week spent on caretaking"</span>,<span class="st">"minutes per week spent on maintenance"</span>,<span class="st">"minutes per week spent on housework"</span>,<span class="st">"minutes per week spent fetching water"</span>,<span class="st">"free time in minutes per week"</span>,<span class="st">"% of income spent on clothing"</span>,<span class="st">"% of income spent on education"</span>,<span class="st">"% of income spent on health"</span>,<span class="st">"% of income spent on transportation"</span>,<span class="st">"% of income spent on personal expenses"</span>,<span class="st">"% of income spent on food"</span>,<span class="st">"percent of income spent on house maintenance"</span>,<span class="st">"percent of income spent on cleaning"</span>,<span class="st">"percent spent on other"</span>,<span class="st">"if family chief married, single man or single woman"</span>,<span class="st">"used to create another variable"</span>,<span class="st">"used to create another variable"</span>,<span class="st">"income percapita"</span>,<span class="st">"Marital status"</span>),</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>vars <span class="sc">%&gt;%</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gt</span>() <span class="sc">%&gt;%</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_header</span>(</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Glossário de Variáveis"</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tab_options</span>(</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">table.font.size =</span> <span class="st">"small"</span>, <span class="co"># tamanho da fonte</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">data_row.padding =</span> <span class="fu">px</span>(<span class="dv">3</span>)   <span class="co"># compactar linhas</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="ozcwbzcyoc" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#ozcwbzcyoc table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#ozcwbzcyoc thead, #ozcwbzcyoc tbody, #ozcwbzcyoc tfoot, #ozcwbzcyoc tr, #ozcwbzcyoc td, #ozcwbzcyoc th {
  border-style: none;
}

#ozcwbzcyoc p {
  margin: 0;
  padding: 0;
}

#ozcwbzcyoc .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: small;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#ozcwbzcyoc .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#ozcwbzcyoc .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#ozcwbzcyoc .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#ozcwbzcyoc .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozcwbzcyoc .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozcwbzcyoc .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#ozcwbzcyoc .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#ozcwbzcyoc .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#ozcwbzcyoc .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#ozcwbzcyoc .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#ozcwbzcyoc .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#ozcwbzcyoc .gt_spanner_row {
  border-bottom-style: hidden;
}

#ozcwbzcyoc .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#ozcwbzcyoc .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#ozcwbzcyoc .gt_from_md > :first-child {
  margin-top: 0;
}

#ozcwbzcyoc .gt_from_md > :last-child {
  margin-bottom: 0;
}

#ozcwbzcyoc .gt_row {
  padding-top: 3px;
  padding-bottom: 3px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#ozcwbzcyoc .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#ozcwbzcyoc .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#ozcwbzcyoc .gt_row_group_first td {
  border-top-width: 2px;
}

#ozcwbzcyoc .gt_row_group_first th {
  border-top-width: 2px;
}

#ozcwbzcyoc .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozcwbzcyoc .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#ozcwbzcyoc .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#ozcwbzcyoc .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozcwbzcyoc .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozcwbzcyoc .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#ozcwbzcyoc .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#ozcwbzcyoc .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#ozcwbzcyoc .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#ozcwbzcyoc .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozcwbzcyoc .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozcwbzcyoc .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#ozcwbzcyoc .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#ozcwbzcyoc .gt_left {
  text-align: left;
}

#ozcwbzcyoc .gt_center {
  text-align: center;
}

#ozcwbzcyoc .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#ozcwbzcyoc .gt_font_normal {
  font-weight: normal;
}

#ozcwbzcyoc .gt_font_bold {
  font-weight: bold;
}

#ozcwbzcyoc .gt_font_italic {
  font-style: italic;
}

#ozcwbzcyoc .gt_super {
  font-size: 65%;
}

#ozcwbzcyoc .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#ozcwbzcyoc .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#ozcwbzcyoc .gt_indent_1 {
  text-indent: 5px;
}

#ozcwbzcyoc .gt_indent_2 {
  text-indent: 10px;
}

#ozcwbzcyoc .gt_indent_3 {
  text-indent: 15px;
}

#ozcwbzcyoc .gt_indent_4 {
  text-indent: 20px;
}

#ozcwbzcyoc .gt_indent_5 {
  text-indent: 25px;
}

#ozcwbzcyoc .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#ozcwbzcyoc div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-postprocess="true" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
<thead>
<tr class="gt_heading header">
<th colspan="3" class="gt_heading gt_title gt_font_normal gt_bottom_border">Glossário de Variáveis</th>
</tr>
<tr class="gt_col_headings even">
<th id="Variável" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Variável</th>
<th id="Tipo" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Tipo</th>
<th id="Descrição" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col">Descrição</th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">folioviv</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">a 6 digit code unique to each household.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">lar</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">-</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">numren</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">ennumerates household members</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">sexo</td>
<td class="gt_row gt_left" headers="Tipo">factor</td>
<td class="gt_row gt_left" headers="Descrição">individual's gender</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">parentesco</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">individual's relation to house chief</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">edad</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">individual's age</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">asis_esc</td>
<td class="gt_row gt_left" headers="Tipo">factor</td>
<td class="gt_row gt_left" headers="Descrição">whether individual is enrolled in school</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">ganha_bolsa</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">whether the individual has a scholarship</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">redsoc_1</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">on a scale of 1-6, how much help could this individual get on a medical emergency</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">redsoc_3</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">---- family emergency</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">redsoc_6</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">---- another emergency</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">trabajo</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">whether the individual works</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">htrab</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">how many hours the individual works</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">conapo</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">the conapo category of the individual's town</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">ing_tri</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">total family progresa transfers. Appears only in the mother's collumn.</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">progresa</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">whether the individual receives progresa transfers</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">renda_tot</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">total family income</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">estrato</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">size of individual's town</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">tam_hog</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">number of individuals in the household</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">tot_hom</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">number of men in the household</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">tot_muj</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">number of women in the household</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">valor_bolsa</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">individual's scholarship, if they receive it</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">bene_gob</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">same as ing_tri, but distributed among all family recipients</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">tempo_cuida</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">minutes per week spent on caretaking</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">tempo_repara</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">minutes per week spent on maintenance</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">tempo_domestico</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">minutes per week spent on housework</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">tempo_agua</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">minutes per week spent fetching water</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">tempo_prazer</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">free time in minutes per week</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">porcent_vest</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on clothing</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">porcent_edu</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on education</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">porcent_sld</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on health</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">porcent_trans</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on transportation</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">porcent_pers</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on personal expenses</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">porcent_ali</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">% of income spent on food</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">porcent_viv</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">percent of income spent on house maintenance</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">porcent_limp</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">percent of income spent on cleaning</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">porcent_man</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">percent spent on other</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">sex_sit_final</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">if family chief married, single man or single woman</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">ingr_tri</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">used to create another variable</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">family_size</td>
<td class="gt_row gt_left" headers="Tipo">integer</td>
<td class="gt_row gt_left" headers="Descrição">used to create another variable</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="Variável">ing_percap</td>
<td class="gt_row gt_left" headers="Tipo">numeric</td>
<td class="gt_row gt_left" headers="Descrição">income percapita</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="Variável">marital_status</td>
<td class="gt_row gt_left" headers="Tipo">character</td>
<td class="gt_row gt_left" headers="Descrição">Marital status</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="understanding-family-income" class="level2">
<h2 class="anchored" data-anchor-id="understanding-family-income">Understanding family income</h2>
<p>Many things can affect the way a family chooses to distribute its resources- from the bargaining power of each member, to their income. The aim of this section is to observe how different factors influence family income, so that later we can relate these factors to different ways these families may choose to distribute said income. In order for me to better understand what is behind income, I run a multiple regression.</p>
<p>Since this regression is under family income and not salary, gender (for example) does not seem to have a statistically significant impact. What does have significant impact is the interaction between marital status and gender. What this impact shows us, is that, among single income families, families with a single mother have in fact lower income than families with a single father. Evidently, double-income families tend to earn more than any and all configurations of single-income families.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>dados_subset<span class="ot">&lt;-</span><span class="fu">subset</span>(df_with_children, parentesco <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chefe"</span>,<span class="st">"partner"</span>) <span class="sc">&amp;</span> renda_tot<span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> <span class="fu">is.finite</span>(df_with_children<span class="sc">$</span>renda_tot),)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(<span class="fu">log</span>(renda_tot)<span class="sc">~</span>edad<span class="sc">+</span>sexo<span class="sc">*</span>marital_status<span class="sc">+</span>conapo<span class="sc">+</span>porcent_ali, <span class="at">data  =</span>dados_subset, <span class="at">na.action =</span> na.omit)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(reg1, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">title =</span> <span class="st">"Regression on familial income. NOT SALARY"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression on familial income. NOT SALARY
============================================================
                                    Dependent variable:     
                                ----------------------------
                                       log(renda_tot)       
------------------------------------------------------------
edad                                      0.007***          
                                          (0.0002)          
                                                            
sexoMenina                                 0.010            
                                          (0.006)           
                                                            
marital_statussingle                     -0.178***          
                                          (0.023)           
                                                            
conapo                                    0.205***          
                                          (0.002)           
                                                            
porcent_ali                              -1.630***          
                                          (0.011)           
                                                            
sexoMenina:marital_statussingle          -0.070***          
                                          (0.025)           
                                                            
Constant                                  9.584***          
                                          (0.016)           
                                                            
------------------------------------------------------------
Observations                               44,214           
R2                                         0.480            
Adjusted R2                                0.480            
Residual Std. Error                  0.616 (df = 44207)     
F Statistic                     6,810.693*** (df = 6; 44207)
============================================================
Note:                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Married women have larger familial income than single women. This difference justifies observing married women and single women separately. Furthermore, families with lower income tend to prioritize basic necessities like food, and because they earn less, a bigger fraction of their income goes toward it. This explains why expenditure on food shows up in the regression as having a positive impact. It also tells us we can use high fractions of food expenditures as a proxy for lower income per capita.</p>
<p>Although this project is not focused on expenditure distribution, but rather on time distribution, understanding what characteristics impact income negatively can help characterize the demographic of Progresa recipients, and understand who is more susceptible to income vulnerability and therefore targeted by Progresa to receive the cash transfers.</p>
</section>
<section id="understanding-time-distribution" class="level2">
<h2 class="anchored" data-anchor-id="understanding-time-distribution">Understanding time distribution</h2>
<p>The way a person chooses to spend their time says much about the commodities they have access to, the challenges they face and the impact of the public policies that target them. A further look into underage girls time distribution compared to boys’ would shine some much needed light on the origin of gender inequalities, especially when it comes to how each gender spends their time at home. After all, it is not only after marriage that girls start contributing more to housework- that pattern has been formed by chidhood behavior and by observing how parents distribute chores. Therefore, it is important to know at what point gender starts making a difference.</p>
<section id="a-general-view" class="level3">
<h3 class="anchored" data-anchor-id="a-general-view">a general view</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtra até 18 anos e transforma para formato longo</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>df_long <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(edad <span class="sc">&lt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> tempo_cuida<span class="sc">:</span>tempo_prazer, <span class="at">names_to =</span> <span class="st">"atividade"</span>, <span class="at">values_to =</span> <span class="st">"tempo"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(tempo), <span class="sc">!</span><span class="fu">is.na</span>(sexo))</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Calcula a média de tempo por gênero e atividade</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>df_media <span class="ot">&lt;-</span> df_long <span class="sc">%&gt;%</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(sexo, atividade) <span class="sc">%&gt;%</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">media_tempo =</span> <span class="fu">mean</span>(tempo, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Define os rótulos das atividades</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>atividades_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">tempo_cuida =</span> <span class="st">"caretaking"</span>,</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">tempo_repara =</span> <span class="st">"other chores"</span>,</span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">tempo_domestico=</span><span class="st">"housework"</span>,</span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">tempo_agua =</span> <span class="st">"fetching water"</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">tempo_prazer =</span> <span class="st">"tempo livre"</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Gera o gráfico</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df_media, <span class="fu">aes</span>(<span class="at">x =</span> atividade, <span class="at">y =</span> media_tempo, <span class="at">fill =</span> sexo)) <span class="sc">+</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> atividades_labels) <span class="sc">+</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"average time spent per activity (under 18 years old), per gender"</span>,</span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"activity"</span>,</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"avg time (minutes)"</span>,</span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"gender"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_project_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Female-centered activities (caretaking and housework) present a gender gap, while both men and women spend little time on male-dominated activities. Therefore, men have slightly more free time than women.</p>
<p>This graph is limited to underage boys and girls, but in future versions of this project it would be desirable to allow the viewer to choose which age group they would like to observe.</p>
</section>
<section id="linear-regression-on-time-spent-on-housework" class="level3">
<h3 class="anchored" data-anchor-id="linear-regression-on-time-spent-on-housework">Linear regression on Time spent on housework</h3>
<p>To better understand what is behind the housework gap, a linear regression can help us.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#aqui</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>dados_subs<span class="ot">&lt;-</span><span class="fu">subset</span>(df_with_children, parentesco <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chefe"</span>,<span class="st">"filho(a)"</span>,<span class="st">"partner"</span>), edad<span class="sc">&lt;</span><span class="dv">20</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>reg1<span class="ot">&lt;-</span><span class="fu">lm</span>(tempo_domestico<span class="sc">~</span>asis_esc<span class="sc">*</span>sexo<span class="sc">+</span>ing_percap<span class="sc">+</span>edad<span class="sc">+</span>conapo<span class="sc">+</span>tot_muj<span class="sc">+</span>parentesco<span class="sc">+</span>marital_status<span class="sc">+</span>marital_status<span class="sc">:</span>sexo, <span class="at">data  =</span>dados_subs)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(reg1, <span class="at">type =</span> <span class="st">"text"</span>, <span class="at">title =</span> <span class="st">"Regression on time spent on housework, for population under 20"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Regression on time spent on housework, for population under 20
=================================================================
                                         Dependent variable:     
                                    -----------------------------
                                           tempo_domestico       
-----------------------------------------------------------------
asis_escNão                                  -64.616***          
                                              (14.057)           
                                                                 
sexoMenina                                   267.990***          
                                              (14.725)           
                                                                 
ing_percap                                    -0.003***          
                                              (0.0003)           
                                                                 
edad                                          3.026***           
                                               (0.295)           
                                                                 
conapo                                         -2.713            
                                               (2.554)           
                                                                 
tot_muj                                       -6.835***          
                                               (2.489)           
                                                                 
parentescofilho(a)                           -119.343***         
                                              (35.319)           
                                                                 
parentescopartner                            204.140***          
                                              (19.482)           
                                                                 
marital_statusnot_single                     -227.299***         
                                              (33.435)           
                                                                 
marital_statussingle                                             
                                                                 
                                                                 
asis_escNão:sexoMenina                       327.009***          
                                              (19.394)           
                                                                 
sexoMenina:marital_statusnot_single          480.473***          
                                              (23.678)           
                                                                 
sexoMenina:marital_statussingle               96.416**           
                                              (37.433)           
                                                                 
Constant                                     470.563***          
                                              (39.574)           
                                                                 
-----------------------------------------------------------------
Observations                                   70,015            
R2                                              0.270            
Adjusted R2                                     0.270            
Residual Std. Error                     852.648 (df = 70002)     
F Statistic                         2,153.565*** (df = 12; 70002)
=================================================================
Note:                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Here, we confirm what was previously suspected- that the main factor behind time spent doing housework is gender. However, not going to school whilst being a girl also plays an important part. In mexico, young girls tend to leave school earlier than boys because gender biases make female education seem futile. Progresa combats this issue by giving larger cash transfers to families who keep daughters in school.</p>
<p>This calls into question how efficient Progresa is at altering time distributions.</p>
</section>
<section id="progresas-impact-on-time-distribution" class="level3">
<h3 class="anchored" data-anchor-id="progresas-impact-on-time-distribution">Progresa’s impact on time distribution</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#it is necessary to limit income per capita, or else higher income can make progresa look like it has negative impact. Since people who are close to qualifying but do not qualify for progresa because their income isn't low enough are included, some effects of progresa may be underestimated here.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#first, I filter the individuals I want in the chart</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>f1 <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexo <span class="sc">==</span> <span class="st">"Menina"</span>, conapo<span class="sc">&lt;=</span><span class="dv">2</span>,ing_percap<span class="sc">&lt;</span><span class="dv">1000</span>, edad<span class="sc">&lt;=</span><span class="dv">18</span>, edad<span class="sc">&gt;</span><span class="dv">10</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#differentiating progresa receivers from non-receivers</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>f2 <span class="ot">&lt;-</span> f1 <span class="sc">%&gt;%</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(progresa), <span class="st">"Receives Progresa"</span>, <span class="st">"Does not receive"</span>))</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Here I relate the groups I created to the time distribution variables</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> f2 <span class="sc">%&gt;%</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group, tempo_cuida<span class="sc">:</span>tempo_prazer) <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> tempo_cuida<span class="sc">:</span>tempo_prazer, <span class="at">names_to =</span> <span class="st">"activity"</span>, <span class="at">values_to =</span> <span class="st">"pct_time"</span>)</span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="co">#here I name the time columns</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> f3 <span class="sc">%&gt;%</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">activity =</span> <span class="fu">recode</span>(activity,</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_cuida"</span> <span class="ot">=</span> <span class="st">"caretaking"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_domestico"</span> <span class="ot">=</span> <span class="st">"cleaning"</span>,</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_repara"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_prazer"</span> <span class="ot">=</span> <span class="st">"leisure"</span>,</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_agua"</span><span class="ot">=</span> <span class="st">"getting water"</span>))</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a><span class="co">#I extract the mean of each category</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>avg_time <span class="ot">&lt;-</span> f3 <span class="sc">%&gt;%</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group, activity) <span class="sc">%&gt;%</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_pct_time =</span> <span class="fu">mean</span>(pct_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co">#create the chart itself</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_time, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> avg_pct_time, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Receives Progresa"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"Does not receive"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Time Allocation for girls between 10 and 18, conapo &lt; 3, income percapita&lt;1000 pesos"</span>,</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Activity"</span>,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average minutes per week"</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Family Progresa Status"</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_project_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The bigger difference for underage girls seems to be the time spent on housework. However, mothers are also affected by progresa’s focus on young girls. With the compulsory school attendance, women likely have more time to work outside of their home. They might, however, have to make up for the help their daughters have now stopped giving.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">#I do the same thing here as in the last chart, except this one is focused on mothers</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>sisters <span class="ot">&lt;-</span> df_with_children <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sexo <span class="sc">==</span> <span class="st">"Menina"</span>, conapo<span class="sc">&lt;=</span><span class="dv">2</span>,ing_percap<span class="sc">&lt;</span><span class="dv">1000</span>, parentesco <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"chefe"</span>,<span class="st">"partner"</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>sisters_with_1_brother <span class="ot">&lt;-</span> sisters <span class="sc">%&gt;%</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">ifelse</span>(<span class="sc">!</span><span class="fu">is.na</span>(progresa), <span class="st">"Receives Progresa"</span>, <span class="st">"Does not receive"</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>sisters_long <span class="ot">&lt;-</span> sisters_with_1_brother <span class="sc">%&gt;%</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(group, tempo_cuida<span class="sc">:</span>tempo_prazer) <span class="sc">%&gt;%</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> tempo_cuida<span class="sc">:</span>tempo_prazer, <span class="at">names_to =</span> <span class="st">"activity"</span>, <span class="at">values_to =</span> <span class="st">"pct_time"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>sisters_long <span class="ot">&lt;-</span> sisters_long <span class="sc">%&gt;%</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">activity =</span> <span class="fu">recode</span>(activity,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_cuida"</span> <span class="ot">=</span> <span class="st">"caretaking"</span>,</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_domestico"</span> <span class="ot">=</span> <span class="st">"cleaning"</span>,</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_repara"</span> <span class="ot">=</span> <span class="st">"other"</span>,</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_prazer"</span> <span class="ot">=</span> <span class="st">"leisure"</span>,</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>                           <span class="st">"tempo_agua"</span><span class="ot">=</span> <span class="st">"getting water"</span>))</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>avg_time <span class="ot">&lt;-</span> sisters_long <span class="sc">%&gt;%</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(group, activity) <span class="sc">%&gt;%</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avg_pct_time =</span> <span class="fu">mean</span>(pct_time, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="at">.groups =</span> <span class="st">"drop"</span>)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_time, <span class="fu">aes</span>(<span class="at">x =</span> activity, <span class="at">y =</span> avg_pct_time, <span class="at">fill =</span> group)) <span class="sc">+</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>(<span class="at">position =</span> <span class="st">"dodge"</span>) <span class="sc">+</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"Receives Progresa"</span> <span class="ot">=</span> <span class="st">"#1f77b4"</span>, <span class="st">"Does not receive"</span> <span class="ot">=</span> <span class="st">"#ff7f0e"</span>)) <span class="sc">+</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Average Time Allocation for mothers, conapo &lt; 3, income percapita&lt;1000 pesos"</span>,</span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Activity"</span>,</span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Average minutes per week"</span>,</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> <span class="st">"Family Progresa Status"</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="R_project_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>It is important to note that here, there is no differentiation between married or single women, since in the next steps I plan on allowing the viewer to select which group they want to view a chart on.</p>
<p>Progresa’s conditional cash transfer is able to change time distribution for all ages. Young girls do less housework, presumably because they have compulsory attendance rates in school, and are not allowed to abandon their education. Mothers, in turn, spend less time on caretaking, since their children (of all ages) are going to school. As we can see, their leisure time does not change, presumably because they are taking up other obligations during that free time.</p>
</section>
<section id="section" class="level3">
<h3 class="anchored" data-anchor-id="section"></h3>
</section>
</section>
<section id="next-steps" class="level2">
<h2 class="anchored" data-anchor-id="next-steps">Next steps</h2>
<p>More complex and interactive graphs where the reader is able to select which information they may want to access, and in which format. (Our World in Data style).</p>
<p>When it comes to the linear regression specifically, I would like for anyone accessing the project to do the following:</p>
<ol type="1">
<li><p>given an “explained” variable, like time spent on housework, the user should be able to pick from a list of explanatory variables and be given visual insights into how the explanatory variable affects the explained variable.</p></li>
<li><p>given a level variable, the user should be able to filter the levels included in the analysis</p></li>
<li><p>given a continuous variable, the user should be able to select intervals to observe</p></li>
<li><p>these functions should interact among themselves</p></li>
<li><p>the user should be able to choose between different types of data representation</p></li>
</ol>
<p>Furthermore, it would be ideal to expand upon expenditure distribution as well, and not be restricted to time distribution.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>